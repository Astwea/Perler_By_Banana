# Nano Banana API 集成使用说明

## 功能概述

在拼豆图案生成之前，可以选择使用 Nano Banana AI 将原图转换为拼豆风格图片，然后再生成拼豆图案。这样可以获得更好的拼豆风格效果。

## 配置步骤

### 1. 配置 API

在界面中找到 "Nano Banana API 配置" 部分：
- 输入 **API密钥**：您的 Nano Banana API 密钥
- 输入 **API基础URL**：API服务器地址（默认：`https://api.grsai.com`）
- 点击 **保存配置**

配置会保存在当前会话中，重启服务器后需要重新配置。

### 2. 使用 Nano Banana

1. **上传图片**：先上传原始图片
2. **启用 Nano Banana**：在参数设置区域，勾选 "使用Nano Banana AI转换"
3. **设置参数**：
   - **提示词**：描述想要的拼豆风格效果（默认："拼豆风格，像素艺术，清晰的色块"）
   - **模型**：选择使用的模型
     - `nano-banana-fast`：快速模式
     - `nano-banana`：标准模式
     - `nano-banana-pro`：专业模式
     - 其他专业模型...
   - **图像大小**：选择生成图片的大小（1K/2K/4K）
4. **生成图案**：点击"生成图案"按钮

## 处理流程

1. 上传原始图片
2. 如果启用了 Nano Banana：
   - 将本地图片转换为 Base64 编码
   - 调用 Nano Banana API 生成拼豆风格图片
   - 下载生成的图片
   - 使用生成的图片继续后续处理
3. 如果未启用 Nano Banana：
   - 直接使用原始图片进行后续处理
4. 生成拼豆图案

## 注意事项

1. **API密钥安全**：API密钥仅在当前会话中有效，不会永久保存
2. **处理时间**：使用 Nano Banana 会增加处理时间，请耐心等待
3. **图片格式**：支持 PNG、JPG、WEBP 等格式
4. **Base64编码**：系统会自动将本地图片转换为 Base64 格式发送给API
5. **错误处理**：如果 Nano Banana API 调用失败，系统会自动使用原始图片继续处理

## API 模型说明

- **nano-banana-fast**：快速生成，适合快速预览
- **nano-banana**：标准质量，平衡速度和质量
- **nano-banana-pro**：高质量，需要更长时间
- **nano-banana-pro-vip**：VIP 模型，更高质量
- **nano-banana-pro-4k-vip**：4K 高质量，需要最长处理时间

## 提示词建议

推荐的提示词示例：
- "拼豆风格，像素艺术，清晰的色块"
- "拼豆风格，像素画，马赛克效果"
- "拼豆风格，像素艺术，色彩鲜艳，清晰边界"

## 故障排除

如果遇到问题：
1. 检查 API 密钥是否正确
2. 检查 API 基础URL是否正确
3. 查看服务器日志了解详细错误信息
4. 如果 API 调用失败，可以取消勾选使用 Nano Banana，直接使用原始图片

